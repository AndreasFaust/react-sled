{"ast":null,"code":"import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nimport _Object$defineProperties from \"@babel/runtime-corejs2/core-js/object/define-properties\";\nimport _Object$getOwnPropertyDescriptors from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\";\nimport _Object$getOwnPropertyDescriptor from \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\";\nimport _Object$getOwnPropertySymbols from \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/andreasfaust/components/react-sled/sled/springs.tsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect } from 'react';\nimport { useSpring, animated } from 'react-spring';\nimport { useStateContext } from './state';\nimport useDragGesture from './hooks/useDragGesture';\nimport useFocus from './hooks/useFocus';\nimport useCursor from './hooks/useCursor';\nimport useX from './hooks/useX';\nimport { useSliderStyles, useViewStyles } from './hooks/useContainerStyles';\n\nconst SledSprings = ({\n  onAnimationStart,\n  onAnimationEnd,\n  onSledEnd,\n  children\n}) => {\n  const [{\n    currentIndex,\n    viewCount,\n    direction,\n    dimensions: {\n      width,\n      height\n    },\n    config\n  }, dispatch] = useStateContext();\n  const cursor = useCursor();\n  const x = useX();\n  const [props, set] = useSpring(() => ({\n    x: 0,\n    cursor,\n    config,\n    immediate: true\n  }));\n  const springRef = React.useRef();\n  useFocus(springRef);\n  const [dimensionsUpdated, setDimensionsUpdated] = React.useState(false);\n  useEffect(() => {\n    setDimensionsUpdated(true);\n  }, [width, height]);\n  useEffect(() => {\n    if (!dimensionsUpdated) return;\n    setDimensionsUpdated(false);\n    set({\n      x,\n      immediate: true,\n      onStart: null,\n      onRest: null\n    });\n  }, [x, dimensionsUpdated]);\n  useEffect(() => {\n    if (dimensionsUpdated) return;\n    set({\n      config,\n      x,\n      cursor,\n      immediate: false,\n\n      onStart() {\n        dispatch({\n          type: 'SET_PAUSE',\n          pause: true\n        });\n        if (typeof onAnimationStart === 'function') onAnimationStart();\n      },\n\n      onRest() {\n        dispatch({\n          type: 'SET_PAUSE',\n          pause: false\n        });\n        if (typeof onAnimationEnd === 'function') onAnimationEnd();\n\n        if (currentIndex === viewCount - 1) {\n          if (typeof onSledEnd === 'function') onSledEnd();\n        }\n      }\n\n    });\n  }, [x, currentIndex, dimensionsUpdated, viewCount, cursor]);\n  const bind = useDragGesture(set);\n  const sliderStyles = useSliderStyles();\n  const viewStyles = useViewStyles();\n  return __jsx(animated.div, _extends({}, bind ? bind() : {}, {\n    className: \"sled-slider\",\n    ref: springRef,\n    style: _objectSpread({}, sliderStyles, {\n      transform: direction === 'horizontal' ? props.x.to(x => `translate3d(${x}px,0,0)`) : props.x.to(x => `translate3d(0,${x}px,0)`),\n      cursor: props.cursor\n    }),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }), React.Children.map(children, child => __jsx(\"div\", {\n    className: \"sled-element\",\n    style: viewStyles,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }, child)));\n};\n\nexport default SledSprings;","map":{"version":3,"sources":["/Users/andreasfaust/components/react-sled/sled/springs.tsx"],"names":["React","useEffect","useSpring","animated","useStateContext","useDragGesture","useFocus","useCursor","useX","useSliderStyles","useViewStyles","SledSprings","onAnimationStart","onAnimationEnd","onSledEnd","children","currentIndex","viewCount","direction","dimensions","width","height","config","dispatch","cursor","x","props","set","immediate","springRef","useRef","dimensionsUpdated","setDimensionsUpdated","useState","onStart","onRest","type","pause","bind","sliderStyles","viewStyles","transform","to","Children","map","child"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react'\nimport { useSpring, animated } from 'react-spring'\n\nimport { useStateContext } from './state'\nimport useDragGesture from './hooks/useDragGesture'\nimport useFocus from './hooks/useFocus'\nimport useCursor from './hooks/useCursor'\nimport useX from './hooks/useX'\nimport { useSliderStyles, useViewStyles } from './hooks/useContainerStyles'\n\ninterface IProps {\n  onAnimationStart(): void\n  onAnimationEnd(): void\n  onSledEnd(): void\n  children?: React.ReactNode\n}\n\nconst SledSprings: React.FC<IProps> = ({\n  onAnimationStart,\n  onAnimationEnd,\n  onSledEnd,\n  children\n}) => {\n  const [{\n    currentIndex,\n    viewCount,\n    direction,\n    dimensions: { width, height },\n    config,\n  }, dispatch] = useStateContext()\n\n  const cursor = useCursor()\n  const x = useX()\n\n  const [props, set] = useSpring(() => ({\n    x: 0,\n    cursor,\n    config,\n    immediate: true\n  }))\n  const springRef = React.useRef()\n\n  useFocus(springRef)\n\n  const [dimensionsUpdated, setDimensionsUpdated] = React.useState(false)\n\n  useEffect(() => {\n    setDimensionsUpdated(true)\n  }, [width, height])\n\n  useEffect(() => {\n    if (!dimensionsUpdated) return\n    setDimensionsUpdated(false)\n    set({\n      x,\n      immediate: true,\n      onStart: null,\n      onRest: null,\n    })\n  }, [x, dimensionsUpdated])\n\n  useEffect(() => {\n    if (dimensionsUpdated) return\n    set({\n      config,\n      x,\n      cursor,\n      immediate: false,\n      onStart() {\n        dispatch({ type: 'SET_PAUSE', pause: true })\n        if (typeof onAnimationStart === 'function') onAnimationStart()\n      },\n      onRest() {\n        dispatch({ type: 'SET_PAUSE', pause: false })\n        if (typeof onAnimationEnd === 'function') onAnimationEnd()\n        if (currentIndex === viewCount - 1) {\n          if (typeof onSledEnd === 'function') onSledEnd()\n        }\n      },\n    })\n  }, [x, currentIndex, dimensionsUpdated, viewCount, cursor])\n\n  const bind = useDragGesture(set)\n\n  const sliderStyles = useSliderStyles()\n  const viewStyles = useViewStyles()\n\n  return (\n    <animated.div\n      {...bind ? bind() : {}}\n      className='sled-slider'\n      ref={springRef}\n      style={{\n        ...sliderStyles,\n        transform: direction === 'horizontal'\n          ? props.x.to((x) => `translate3d(${x}px,0,0)`)\n          : props.x.to((x) => `translate3d(0,${x}px,0)`),\n        cursor: props.cursor,\n      }}\n    >\n      {\n        React.Children.map(children, child => (\n          <div\n            className=\"sled-element\"\n            style={viewStyles}\n          >\n            {child}\n          </div>\n        ))\n      }\n    </animated.div >\n  )\n}\n\n\nexport default SledSprings\n"]},"metadata":{},"sourceType":"module"}